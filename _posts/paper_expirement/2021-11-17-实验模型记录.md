# 实验模型记录



这里用来记录实验跑完后得到的模型具体信息



## 1. model_crossentropy.pkl

它是用huggingface提供的robertafortokenclassifition模型在数据集上直接训练得到的。

训练代码见hf_roberta.py。

loss_train: 1.635871, loss_valid: 1.072391, acc: 93.1439%

acc保持不变，我测试了几个句子，发现效果非常差，因为样本标签分布极度不均衡：

```
+----+------------+--------+--------+
|    | 0          |    cnt | %      |
|----+------------+--------+--------|
|  0 | O          | 138861 | 79.04% |
|  1 | B-HackOrg  |   4214 | 2.40%  |
|  2 | B-Tool     |   3081 | 1.75%  |
|  3 | B-Area     |   2531 | 1.44%  |
|  4 | I-Tool     |   1703 | 0.97%  |
|  5 | B-Time     |   1677 | 0.95%  |
|  6 | B-OffAct   |   1662 | 0.95%  |
|  7 | B-SamFile  |   1660 | 0.94%  |
|  8 | B-Idus     |   1579 | 0.90%  |
|  9 | I-Purp     |   1506 | 0.86%  |
| 10 | I-Features |   1416 | 0.81%  |
| 11 | B-Org      |   1361 | 0.77%  |
| 12 | B-Exp      |   1331 | 0.76%  |
| 13 | B-SecTeam  |   1327 | 0.76%  |
| 14 | I-HackOrg  |   1243 | 0.71%  |
| 15 | I-Org      |   1128 | 0.64%  |
| 16 | B-Way      |   1037 | 0.59%  |
| 17 | B-Features |   1025 | 0.58%  |
| 18 | I-OffAct   |   1007 | 0.57%  |
| 19 | I-Time     |    981 | 0.56%  |
| 20 | I-Way      |    981 | 0.56%  |
| 21 | B-Purp     |    918 | 0.52%  |
| 22 | I-Area     |    915 | 0.52%  |
| 23 | I-SamFile  |    740 | 0.42%  |
| 24 | I-Exp      |    628 | 0.36%  |
| 25 | I-SecTeam  |    594 | 0.34%  |
| 26 | I-Idus     |    557 | 0.32%  |
| 27 |            |     13 | 0.01%  |
+----+------------+--------+--------+
```

使用metric进行刚详细的评估：

```
              precision    recall  f1-score   support

   B-HackOrg       0.00      0.00      0.00       368
   I-HackOrg       0.00      0.00      0.00       133
    B-OffAct       0.00      0.00      0.00       150
    I-OffAct       0.00      0.00      0.00        91
   B-SamFile       0.00      0.00      0.00       248
   I-SamFile       0.00      0.00      0.00        95
   B-SecTeam       0.00      0.00      0.00       152
   I-SecTeam       0.00      0.00      0.00        56
      B-Tool       0.00      0.00      0.00       312
      I-Tool       0.00      0.00      0.00       153
      B-Time       0.00      0.00      0.00       167
      I-Time       0.00      0.00      0.00       101
      B-Purp       0.00      0.00      0.00       115
      I-Purp       0.00      0.00      0.00       145
      B-Area       0.00      0.00      0.00       216
      I-Area       0.00      0.00      0.00        52
      B-Idus       0.00      0.00      0.00       127
      I-Idus       0.00      0.00      0.00        38
       B-Org       0.00      0.00      0.00       137
       I-Org       0.00      0.00      0.00       101
       B-Way       0.00      0.00      0.00        98
       I-Way       0.00      0.00      0.00        88
       B-Exp       0.00      0.00      0.00       132
       I-Exp       0.00      0.00      0.00        49
  B-Features       0.00      0.00      0.00       116
  I-Features       0.00      0.00      0.00       151
           O       0.93      1.00      0.96     48786

    accuracy                           0.93     52377
   macro avg       0.03      0.04      0.04     52377
weighted avg       0.87      0.93      0.90     52377

```

热力图没保存，因为label过长超出绘图区，懒得解决了



## 2. model_focal.py

把上一个模型的CrossEntropy改成了Focal Loss，希望能解决标签分布不均衡问题，但是事与愿违。

还是一样烂，acc: 93.1439%

```
              precision    recall  f1-score   support

   B-HackOrg       0.00      0.00      0.00       368
   I-HackOrg       0.00      0.00      0.00       133
    B-OffAct       0.00      0.00      0.00       150
    I-OffAct       0.00      0.00      0.00        91
   B-SamFile       0.00      0.00      0.00       248
   I-SamFile       0.00      0.00      0.00        95
   B-SecTeam       0.00      0.00      0.00       152
   I-SecTeam       0.00      0.00      0.00        56
      B-Tool       0.00      0.00      0.00       312
      I-Tool       0.00      0.00      0.00       153
      B-Time       0.00      0.00      0.00       167
      I-Time       0.00      0.00      0.00       101
      B-Purp       0.00      0.00      0.00       115
      I-Purp       0.00      0.00      0.00       145
      B-Area       0.00      0.00      0.00       216
      I-Area       0.00      0.00      0.00        52
      B-Idus       0.00      0.00      0.00       127
      I-Idus       0.00      0.00      0.00        38
       B-Org       0.00      0.00      0.00       137
       I-Org       0.00      0.00      0.00       101
       B-Way       0.00      0.00      0.00        98
       I-Way       0.00      0.00      0.00        88
       B-Exp       0.00      0.00      0.00       132
       I-Exp       0.00      0.00      0.00        49
  B-Features       0.00      0.00      0.00       116
  I-Features       0.00      0.00      0.00       151
           O       0.93      1.00      0.96     48786

    accuracy                           0.93     52377
   macro avg       0.03      0.04      0.04     52377
weighted avg       0.87      0.93      0.90     52377
```

从表格来看和上一个模型没有什么区别。

没区别是因为我脚本开错了

